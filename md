{
    "status": true,
    "message": "Basic Leave Details Fetched",
    "result": [
        {
            "rqstId": 21,
            "userId": 79,
            "leaveTypeId": 3,
            "leaveTypeDesc": "Maternity Leave",
            "rqstFrom": "2024-02-26T13:00:00.000+00:00",
            "rqstTo": "2024-03-01T18:00:00.000+00:00",
            "daysOfLeave": 4,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 22,
            "userId": 79,
            "leaveTypeId": 1,
            "leaveTypeDesc": "Casual Leave",
            "rqstFrom": "2024-02-26T10:00:00.000+00:00",
            "rqstTo": "2024-02-26T18:00:00.000+00:00",
            "daysOfLeave": 0,
            "hoursOfLeave": 1
        },
        {
            "rqstId": 23,
            "userId": 79,
            "leaveTypeId": 3,
            "leaveTypeDesc": "Maternity Leave",
            "rqstFrom": "2024-03-20T10:00:00.000+00:00",
            "rqstTo": "2024-03-23T13:00:00.000+00:00",
            "daysOfLeave": 3,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 24,
            "userId": 79,
            "leaveTypeId": 6,
            "leaveTypeDesc": "Earned Leaves",
            "rqstFrom": "2024-02-26T13:00:00.000+00:00",
            "rqstTo": "2024-03-01T18:00:00.000+00:00",
            "daysOfLeave": 4,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 25,
            "userId": 79,
            "leaveTypeId": 6,
            "leaveTypeDesc": "Earned Leaves",
            "rqstFrom": "2024-02-01T13:00:00.000+00:00",
            "rqstTo": "2024-02-03T18:00:00.000+00:00",
            "daysOfLeave": 2,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 26,
            "userId": 79,
            "leaveTypeId": 6,
            "leaveTypeDesc": "Earned Leaves",
            "rqstFrom": "2024-02-01T13:00:00.000+00:00",
            "rqstTo": "2024-02-03T18:00:00.000+00:00",
            "daysOfLeave": 2,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 27,
            "userId": 79,
            "leaveTypeId": 6,
            "leaveTypeDesc": "Earned Leaves",
            "rqstFrom": "2024-02-01T13:00:00.000+00:00",
            "rqstTo": "2024-02-03T18:00:00.000+00:00",
            "daysOfLeave": 2,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 29,
            "userId": 79,
            "leaveTypeId": 6,
            "leaveTypeDesc": "Earned Leaves",
            "rqstFrom": "2024-02-01T13:00:00.000+00:00",
            "rqstTo": "2024-02-03T18:00:00.000+00:00",
            "daysOfLeave": 2,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 30,
            "userId": 79,
            "leaveTypeId": 6,
            "leaveTypeDesc": "Earned Leaves",
            "rqstFrom": "2024-02-01T13:00:00.000+00:00",
            "rqstTo": "2024-02-03T18:00:00.000+00:00",
            "daysOfLeave": 2,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 31,
            "userId": 79,
            "leaveTypeId": 6,
            "leaveTypeDesc": "Earned Leaves",
            "rqstFrom": "2024-02-01T13:00:00.000+00:00",
            "rqstTo": "2024-02-03T18:00:00.000+00:00",
            "daysOfLeave": 2,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 32,
            "userId": 79,
            "leaveTypeId": 1,
            "leaveTypeDesc": "Casual Leave",
            "rqstFrom": "2024-02-26T10:00:00.000+00:00",
            "rqstTo": "2024-02-26T18:00:00.000+00:00",
            "daysOfLeave": 0,
            "hoursOfLeave": 1
        },
        {
            "rqstId": 33,
            "userId": 79,
            "leaveTypeId": 1,
            "leaveTypeDesc": "Casual Leave",
            "rqstFrom": "2024-02-26T10:00:00.000+00:00",
            "rqstTo": "2024-02-26T18:00:00.000+00:00",
            "daysOfLeave": 0,
            "hoursOfLeave": 1
        },
        {
            "rqstId": 34,
            "userId": 79,
            "leaveTypeId": 2,
            "leaveTypeDesc": "Compensatory Casual Leave",
            "rqstFrom": "2024-02-26T10:00:00.000+00:00",
            "rqstTo": "2024-02-26T13:00:00.000+00:00",
            "daysOfLeave": 0,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 35,
            "userId": 79,
            "leaveTypeId": 2,
            "leaveTypeDesc": "Compensatory Casual Leave",
            "rqstFrom": "2024-02-26T13:00:00.000+00:00",
            "rqstTo": "2024-02-26T18:00:00.000+00:00",
            "daysOfLeave": 0,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 36,
            "userId": 79,
            "leaveTypeId": 6,
            "leaveTypeDesc": "Earned Leaves",
            "rqstFrom": "2024-02-01T13:00:00.000+00:00",
            "rqstTo": "2024-02-03T18:00:00.000+00:00",
            "daysOfLeave": 2,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 37,
            "userId": 79,
            "leaveTypeId": 6,
            "leaveTypeDesc": "Earned Leaves",
            "rqstFrom": "2024-02-01T13:00:00.000+00:00",
            "rqstTo": "2024-02-03T18:00:00.000+00:00",
            "daysOfLeave": 2,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 38,
            "userId": 79,
            "leaveTypeId": 6,
            "leaveTypeDesc": "Earned Leaves",
            "rqstFrom": "2024-02-01T13:00:00.000+00:00",
            "rqstTo": "2024-02-03T18:00:00.000+00:00",
            "daysOfLeave": 2,
            "hoursOfLeave": 0.5
        },
        {
            "rqstId": 39,
            "userId": 79,
            "leaveTypeId": 2,
            "leaveTypeDesc": "Compensatory Casual Leave",
            "rqstFrom": "2024-02-01T13:00:00.000+00:00",
            "rqstTo": "2024-02-05T18:00:00.000+00:00",
            "daysOfLeave": 4,
            "hoursOfLeave": 0.5
        }
    ],
    "statusCode": 200
}




import React, { useState, useEffect } from 'react'
import SearchTable from '../../../components/SearchTableAlt';
import {Grid, Box, Card, CardContent, IconButton, Stack, Button,Link } from '@mui/material';
import useTitle from '../../../hooks/useTitle';
import PageTitle from '../../../layouts/PageTitle';
import { useNavigate } from 'react-router-dom';
import { H3 } from '../../../components/Typography';
import EventBusyIcon from '@mui/icons-material/EventBusy';
import { useSelector } from 'react-redux';
import axios from 'axios';


const ViewLeaves = () => {

    
    const title = 'View Leaves';
    useTitle(title);

    const navigate = useNavigate();

    const handleNavigation =()=> {
        console.log('called');
        navigate('/leave')
    }
    const user = useSelector((state) => state.loginReducer);
    console.log(user.data.userdetails.user.userId);
    const userId = user.data.userdetails.user.userId;

    
    const [tableData, setTableData] = useState([]);
   
    const handleFetchData = async()=> {
        try {
            const payload = {
                userId : userId
            }

            const response = await axios.post("http://129.154.229.83:8095/leavemanagement/leave-applied-leaves", payload);
            

            console.log('kp-tableDataResponse',response.data);
       
            setTableData(response.data.result);
            if(response.status === true){
                console.log('kp-tableData1', tableData);
                console.log('kp-tableData2', tableData);
  
            }
        } catch (error) {
            console.error(error);
        }
    }

    useEffect(() => {
        handleFetchData();
    }, [])
    const columns = [
            {
                field: "index", //keep this fixed, index should be present for all tables
                headerName: "S.No",
                flex: 0.1,
                minWidth: 80,
                headerClassName: "super-app-theme--header",
            },
            
            {
                field: "leaveTypeId",
                headerName: "Leave ID",
                flex: 0.3,
                minWidth: 120,
                headerClassName: "super-app-theme--header",
                renderCell: (params) => (
                    <Link
                      sx={{ cursor: "pointer" }}
                      onClick={() => {
                        const requestId = params.row.rqstId;
                        navigate("/leaveapplicationview", {state: {requestId}});
                      }}
                    >
                    {params.value}
                    </Link>
                ),
            },
            {
                field: "leaveTypeDesc",
                headerName: "Leave Type",
                flex: 0.3,
                minWidth: 120,
                headerClassName: "super-app-theme--header",
            },

            {
                field: "daysOfLeave",
                headerName: "Days of Leave",
                flex: 0.3,
                minWidth: 150,
                headerClassName: "super-app-theme--header",
            },
            {
                field: "rqstFrom",
                headerName: "Start Date",
                flex: 0.3,
                minWidth: 120,
                headerClassName: "super-app-theme--header",
            },
            {
                field: "rqstTo",
                headerName: "End Date",
                flex: 0.3,
                minWidth: 120,
                headerClassName: "super-app-theme--header",
            },

            {
                field: "action",
                headerName: "Action",
                flex: 0.2,
                minWidth: 200,
                headerClassName: "super-app-theme--header",
                sortable: false,
                renderCell: (params) => {
                    return (
                        <Stack direction="row" spacing={1}>
                        <Button variant="outlined" color="error" onClick={console.log('abc')}>
                          Cancel Leave Request
                        </Button>
                            {/* <IconButton style={{ color: "#2169b3" }} >
                                <InfoIcon />
                            </IconButton> */}
                        </Stack>
                    );
                },
            },
            
        ];

    const rows  = [
        {index: 1, leaveId: 'LV14022024', leaveType:'Sick Leave', total:'2',startDate:'17/01/2024',endDate:'18/01/2024',stationLeave:'No'},
        {index: 2, leaveId: 'LV10022024', leaveType:'Normal Leave', total:'1', startDate:'14/01/2024',endDate:'14/01/2024',stationLeave:'No'},
    ]

    console.log('kp-tabledata3', tableData)
  return (
    <>
        <Card sx={{ my: 2 }} elevation={3}>
            <CardContent>
                {/* <PageTitle name={title} />
                 */}
                <div style={{display:"flex",justifyContent:"left",alignItems:'center', marginBlock:15, borderBottom: "0.5px solid #d1d1cf", marginTop:'30px'}}>
                    <EventBusyIcon sx={{fontSize:"25px", color:'#246cb5'}}/>
                    <H3 sx={{fontSize: "15px", color:'#246cb5'}} marginLeft={0.5} my={0.5} display="flex" justifyContent="center" alignItems="flex-end">Leave Application</H3>
                </div>
                <Box component={"div"} >
                    <Grid sx={{display:'flex', justifyContent:'flex-end', marginBottom:2}}>
                        <Button variant={'contained'} onClick={handleNavigation}>Apply for a new leave</Button>
                    </Grid>
                    <SearchTable
                        columns={columns}
                        data={tableData}
                        isCheckbox={false}
                        isHideDensity={false}
                        isHideExport={true}
                        isHideFilter={true}
                        isHideColumn={true}
                        isHidePaging={false}
                        name="abc"
                        id="hjjh"
                    />
                </Box>
            </CardContent>
        </Card>
    </>
  )
}

export default ViewLeaves
