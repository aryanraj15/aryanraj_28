import React, { useState, useEffect } from "react";
import { Button, Card, CardContent, Grid, Typography } from "@mui/material";
import FormControlLabel from "@mui/material/FormControlLabel";
import FormControl from "@mui/material/FormControl";
import Checkbox from "@mui/material/Checkbox";
import FormGroup from "@mui/material/FormGroup";
import Modal from "./applicationViewdetails.js";

function Payumoney(props) {
  const {
    applicationnum,
    mobilenumber,
    username,
    totalpayamount,
    applicationid,
  } = props;

  const [paymentdetails, setpaymentdetails] = useState({});
  const [checkboxChecked, setCheckboxChecked] = useState(false);

  const handleCheckboxChange = () => {
    setCheckboxChecked(!checkboxChecked);
  };

  const handleSubmit = (event) => {
    event.preventDefault();
    const form = event.target;
    form.action = "https://secure.payu.in/_payment";
    form.submit();
  };

  const isPayButtonDisabled = !checkboxChecked;

  const renderButton = () => {
    if (totalpayamount === 0) {
      return (
        <Button
          sx={{ borderRadius: "5px" }}
          type="submit"
          variant="contained"
          onClick={handleSubmit}
          disabled={isPayButtonDisabled}
        >
          Submit
        </Button>
      );
    } else {
      return (
        <Button
          sx={{ borderRadius: "5px" }}
          type="submit"
          variant="contained"
          onClick={handleSubmit}
          disabled={isPayButtonDisabled}
        >
          Pay
        </Button>
      );
    }
  };

  useEffect(() => {
    // Your existing code for fetching payment details
  }, []);

  return (
    <>
      <Card sx={{ borderRadius: 5, boxShadow: 4, margin: 1, maxWidth: "auto" }}>
        <CardContent>
          {/* Your existing code for displaying application details */}

          <Grid item display={"flex"} justifyContent={"center"} marginTop={2}>
            <form
              onSubmit={handleSubmit}
              action="https://secure.payu.in/_payment"
              method="post"
            >
              {/* Your existing code for input fields */}

              <Modal applicationid={applicationid} />

              {renderButton()}
            </form>
          </Grid>

          {/* Your existing code for displaying the checkbox */}
        </CardContent>
      </Card>
    </>
  );
}

export default Payumoney;
